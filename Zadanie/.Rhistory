h = ts(H, start=s, end = s + n)
d = ts(D, start=s, end = s + n)
pr = ts(PR, start=s, end = s + n)
lines(pr + predict(lmData3), col = 'blue')
predict(lmData3)
typeof
typeof( + predict(lmData3))
typeof(predict(lmData3))
typeof(pr)
pr + predict(lmData3)
size(lmData3)
length(lmData3)
length(pr)
length(predict((lmData3))
as
length(predict(lmData3))
length(predict(lmData3, n.ahead = 3))
length(predict(lmData3, n.ahead = 5))
length(predict(lmData3))
lmData3(s:(s+n))
help("lm")
predict.lm(lmData3, s:(s+n))
predict.lm(lmData3, data.frame(s:(s+n)), interval = "prediction" )
coefficients(lmData3)
lmData3
plot(data, main = 'Počet porazených ošípaných za obdobie január 1985 - August 1995', ylab = 'Počet porazených ošípaných', type ='o')
#t_predict = length(t):(length(t+3))
#t_predict = 1:(length(t))
n = 3
predictMA1 = predict(modelMA1, n.ahead = n)
predictMA1
s = t[length(t)] + 1
PR = predictMA1$pred
ER = predictMA1$se
H = PR + 1.96 * ER
D = PR - 1.96 * ER
h = ts(H, start=s, end = s + n)
d = ts(D, start=s, end = s + n)
pr = ts(PR, start=s, end = s + n)
plot(pr, col = 'blue')
lines(h, col = 'red')
lines(d, col = 'red')
plot(data, main = 'Počet porazených ošípaných za obdobie január 1985 - August 1995', ylab = 'Počet porazených ošípaných', type ='o')
#t_predict = length(t):(length(t+3))
#t_predict = 1:(length(t))
n = 3
predictMA1 = predict(modelMA1, n.ahead = n)
predictMA1
s = t[length(t)] + 1
PR = predictMA1$pred
ER = predictMA1$se
H = PR + 1.96 * ER
D = PR - 1.96 * ER
plot(PR)
h = ts(H, start=s, end = s + n)
d = ts(D, start=s, end = s + n)
pr = ts(PR, start=s, end = s + n)
plot(pr, col = 'blue')
lines(h, col = 'red')
lines(d, col = 'red')
plot(data, main = 'Počet porazených ošípaných za obdobie január 1985 - August 1995', ylab = 'Počet porazených ošípaných', type ='o')
#t_predict = length(t):(length(t+3))
#t_predict = 1:(length(t))
n = 3
predictMA1 = predict(modelMA1, n.ahead = n)
predictMA1
s = t[length(t)] + 1
PR = predictMA1$pred
ER = predictMA1$se
H = PR + 1.96 * ER
D = PR - 1.96 * ER
h = ts(H, start=s, end = s + n)
d = ts(D, start=s, end = s + n)
pr = ts(PR, start=s, end = s + n)
length(PR)
length(h)
plot(pr, col = 'blue')
lines(h, col = 'red')
lines(d, col = 'red')
plot(data, main = 'Počet porazených ošípaných za obdobie január 1985 - August 1995', ylab = 'Počet porazených ošípaných', type ='o')
#t_predict = length(t):(length(t+3))
#t_predict = 1:(length(t))
n = 3
predictMA1 = predict(modelMA1, n.ahead = n)
predictMA1
s = t[length(t)]
PR = predictMA1$pred
ER = predictMA1$se
H = PR + 1.96 * ER
D = PR - 1.96 * ER
h = ts(H, start=s, end = s + n)
d = ts(D, start=s, end = s + n)
pr = ts(PR, start=s, end = s + n)
length(PR)
length(h)
plot(pr, col = 'blue')
lines(h, col = 'red')
lines(d, col = 'red')
plot(data, main = 'Počet porazených ošípaných za obdobie január 1985 - August 1995', ylab = 'Počet porazených ošípaných', type ='o')
#t_predict = length(t):(length(t+3))
#t_predict = 1:(length(t))
n = 3
predictMA1 = predict(modelMA1, n.ahead = n)
predictMA1
s = t[length(t)] + 1
PR = predictMA1$pred
ER = predictMA1$se
H = PR + 1.96 * ER
D = PR - 1.96 * ER
h = ts(H, start=s, end = s + n - 1)
d = ts(D, start=s, end = s + n - 1)
pr = ts(PR, start=s, end = s + n - 1)
length(PR)
length(h)
plot(pr, col = 'blue')
lines(h, col = 'red')
lines(d, col = 'red')
plot(data, main = 'Počet porazených ošípaných za obdobie január 1985 - August 1995', ylab = 'Počet porazených ošípaných', type ='o')
#t_predict = length(t):(length(t+3))
#t_predict = 1:(length(t))
n = 3
predictMA1 = predict(modelMA1, n.ahead = n)
predictMA1
s = t[length(t)] + 1
PR = predictMA1$pred
ER = predictMA1$se
H = PR + 1.96 * ER
D = PR - 1.96 * ER
h = ts(H, start=s, end = s + n - 1)
d = ts(D, start=s, end = s + n - 1)
pr = ts(PR, start=s, end = s + n - 1)
plot(pr, col = 'blue')
lines(h, col = 'red')
lines(d, col = 'red')
plot(data, main = 'Počet porazených ošípaných za obdobie január 1985 - August 1995', ylab = 'Počet porazených ošípaných', type ='o')
#t_predict = length(t):(length(t+3))
#t_predict = 1:(length(t))
n = 3
predictMA1 = predict(modelMA1, n.ahead = n)
predictMA1
s = t[length(t)] + 1
PR = predictMA1$pred
ER = predictMA1$se
H = PR + 1.96 * ER
D = PR - 1.96 * ER
h = ts(H, start=s, end = s + n - 1)
d = ts(D, start=s, end = s + n - 1)
pr = ts(PR, start=s, end = s + n - 1)
plot(pr, col = 'blue')
lines(h, col = 'red')
lines(d, col = 'red')
lmData3
predict(lmData3)
predict(ts(lmData3)
)
ts(lmData3)
help("poly")
poly(s:(s+n-1),3, coefs = coefficients(lmData3))
poly(s:(s+n-1), coefs = coefficients(lmData3))
poly(seq(s,s+n-1),3, coefs = coefficients(lmData3))
lmData3$coefficients
predict(lmData3, data.frame(t=seq(s,s+n,1)))
predict(lmData3, data.frame(s + 1))
predict(lmData3$fitted.values, data.frame(s + 1))
length(lmData3$fitted.values)
predict(lmData3$coefficients, data.frame(s + 1))
lmData3
length(lmData3)
predict(lmData3$coefficients, seq(s,s+n-1))
a = ts([1, 2, 3])
a = ts(1, 2, 3)
a
a = [1, 2, 3]
a = (1, 2, 3)
s
s[1:5]
s[1:10]
s1[1:10]
a = s1[1:5]
ts(a)
ta = ts(a)
s2[1:10]
s2[1:5]*2
taa = ts(s2[1:5]*2)
ta +taa
ta
taa
h
H
predictMA1
predictMA1$pred
modelMA1
predict(modelMA1)
predict(modelMA1, n= 4)
predict(modelMA1, d = 4)
help("predict")
modelMA1
modelMA1.predict()
predict(modelMA)
predict(modelMA1)
predict.lm(modelMA1)
predict(modelMA1, n.ahead = 4)
h
plot(data, main = 'Počet porazených ošípaných za obdobie január 1985 - August 1995', ylab = 'Počet porazených ošípaných', type ='o')
#t_predict = length(t):(length(t+3))
#t_predict = 1:(length(t))
n = 3
predictMA1 = predict(modelMA1, n.ahead = n)
predictMA1
s = t[length(t)] + 1
PR = predictMA1$pred
ER = predictMA1$se
H = PR + 1.96 * ER
D = PR - 1.96 * ER
h = ts(H, start=s, end = s + n - 1)
d = ts(D, start=s, end = s + n - 1)
pr = ts(PR, start=s, end = s + n - 1)
lines(pr, col = 'blue')
lines(h, col = 'red')
lines(d, col = 'red')
PR
ER
predict(lmData3)
predict(lmData3, n.ahead=3)
lmData3
length(lmData3)
lmData3$model
help("linear model")
help("lm")
predict.lm(lmData3, n.ahead = 3)
predict.lm(lmData3)
lmts = ts(lmData3)
plot(lmts)
lmts = ts(lmData3)
lmts = ts(range(length(lmData3)),lmData3)
lmts = ts(1:length(lmData3),lmData3)
lmts = ts(0:length(lmData3),lmData3)
lmts = ts(0:length(lmData3)+1,lmData3)
1:5
lmData3
lmData3[0]
lmData3[1]
lmData3[2]
lmData3$fitted.values
length(data)
predict.lm(lmData3, 1:(length(data)+3)
)
predict.lm(lmData3, 1:(length(data)+3))
predict(lm(data~t+t2+t3), 1:(length(data)+3))
predict(lm(data~t+t2+t3), data.frame(1:(length(data)+3)))
newTs = predict(lm(data~t+t2+t3), data.frame(1:(length(data)+3)))
plot(newTs)
lines(lmData3)
lines(t, lmData3)
lines(t, predict(lmData3))
lines(t, predict(lmData3), color = 'r')
lines(t, predict(lmData3), color = 'red')
lines(t, predict(lmData3), col = 'red')
lines( data.frame(1:(length(data)+3)), predict(lmData3, data.frame(1:(length(data)+3))), col = 'red')
lines( data.frame(1:(length(data)+3)), predict(lmData3, data.frame(1:(length(data)+3))), col = 'blue')
lines((1:(length(data)+3), predict(lmData3, newdata = data.frame(1:(length(data)+3))), col = 'blue')
lines(1:(length(data)+3), predict(lmData3, newdata = data.frame(1:(length(data)+3))), col = 'blue')
lines(1:(length(data)+3), predict(lm(data~t+t2+t3), newdata = data.frame(1:(length(data)+3))), col = 'blue')
lines(1:(length(data)+3), predict(lm(data~t+t2+t3, data = data), newdata = data.frame(1:(length(data)+3))), col = 'blue')
Osipane <- read.table("Osipane.txt", quote="\"", comment.char="")
dataOsipane = Osipane$V1
plot(dataOsipane, main = 'Počet porazených ošípaných za obdobie január 1985 - August 1995', ylab = 'Počet porazených ošípaných', type ='o')
t = 1:length(data)
t2 = t*t
lmData2 = lm(dataOsipane~t+t2)
plot(dataOsipane, main = 'Počet porazených ošípaných za obdobie január 1985 - August 1995', ylab = 'Počet porazených ošípaných', type ='o')
lines(t, predict(lmData2), col='red')
show(lmData2)
resLm2 = residuals(lmData2)
plot(resLm2, main = 'Reziduá po fite kubickou funkciou',type='o')
t = 1:length(dataOsipane)
t2 = t*t
t3 = t2*t
lmData3 = lm(dataOsipane~t+t2+t3)
plot(dataOsipane, main = 'Počet porazených ošípaných za obdobie január 1985 - August 1995', ylab = 'Počet porazených ošípaných', type ='o')
lines(t, predict(lmData3), col='red')
summary(lmData3)
resLm3 = residuals(lmData3)
plot(resLm3, main = 'Reziduá po fite kubickou funkciou',type='o')
acfLm3 = acf(resLm3,40)
pacfLm3 = pacf(resLm3,40)
Box.test(resLm3)
Box.test(resLm3, type='Ljung')
modelMA1 = arima(resLm3, order=c(0,0,1))
resMA1 = residuals(modelMA1)
plot(resMA1, main='Rezidá MA(1) modelu.', type ='o')
# PACF a ACF
pacfMA1 = pacf(resMA1,40)
acfMA1 = acf(resMA1, 40)
# Box testy
Box.test(resMA1)
Box.test(resMA1, type = 'Ljung')
# Test normality pre reziduá
shapiro.test(resMA1)
coefficients(modelMA1)
pgramData <- spec.pgram(resMA1, log='no')
plot(data, main = 'Počet porazených ošípaných za obdobie január 1985 - August 1995', ylab = 'Počet porazených ošípaných', type ='o')
#t_predict = length(t):(length(t+3))
#t_predict = 1:(length(t))
n = 3
predictMA1 = predict(modelMA1, n.ahead = n)
predictMA1
s = t[length(t)] + 1
PR = predictMA1$pred
ER = predictMA1$se
H = PR + 1.96 * ER
D = PR - 1.96 * ER
h = ts(H, start=s, end = s + n - 1)
d = ts(D, start=s, end = s + n - 1)
pr = ts(PR, start=s, end = s + n - 1)
lines(pr, col = 'blue')
lines(h, col = 'red')
lines(d, col = 'red')
lines(1:(length(data)+3), predict(lm(data~t+t2+t3, data = data), newdata = data.frame(1:(length(data)+3))), col = 'blue')
lm(data~t+t2+t3, data = dataOsipane)
lm(dataOsipane~t+t2+t3, data = dataOsipane)
lm(dataOsipane~t+t2+t3)
predict(lm(dataOsipane~t+t2+t3), n.ahead = 3
)
predict(lm(dataOsipane~t+t2+t3), interval = "prediction")
tNew = 1:(length(t)+30)
predict(lm(dataOsipane~t+t2+t3, data = tNew), interval = "prediction")
predict(lm(dataOsipane~t+t2+t3), data=tNew interval = "prediction")
predict(lm(dataOsipane~t+t2+t3), data=tNew, interval = "prediction")
predict(lm(dataOsipane~t+t2+t3), data=tNew)
predict(lm(dataOsipane~t+t2+t3), newdata=tNew)
predict(lm(dataOsipane~t+t2+t3), newdata=data.frame(tNew))
lmData3$model
summary(lmData3)
predict(lm(formulaOsipane = dataOsipane~t+t2+t3), newdata=data.frame(tNew))
lm3 = lm(formulaOsipane = dataOsipane~t+t2+t3)
lmData3
lmData3$terms
lmData3$t
lmData3$coefficients
lmData3$coefficients$t
lmData3$coefficients[0]
lmData3$coefficients[1]
lmData3$coefficients[2]
lmData3$coefficients[3]
[(length(t)+1):(length(t)+3)
[(length(t)+1):(length(t)+3)]
(length(t)+1):(length(t)+3)
tx = (length(t)+1):(length(t)+3)
predict.lm(lmData3, t = tx)
predict.lm(lmData3, newdata.frame(t = tx, t2 = tx*tx, t3 = tx*tx*tx))
predict.lm(lmData3, newdata = data.frame(t = tx, t2 = tx*tx, t3 = tx*tx*tx))
tx
lmData3
plot(data, main = 'Počet porazených ošípaných za obdobie január 1985 - August 1995', ylab = 'Počet porazených ošípaných', type ='o')
#t_predict = length(t):(length(t+3))
#t_predict = 1:(length(t))
n = 3
tx = (length(t)+1):(length(t)+n)
predictLm3 = predict.lm(lmData3, newdata = data.frame(t = tx, t2 = tx*tx, t3 = tx*tx*tx))
predictMA1 = predict(modelMA1, n.ahead = n)
predictMA1
s = t[length(t)] + 1
PR = predictMA1$pred
ER = predictMA1$se
H = PR + 1.96 * ER
D = PR - 1.96 * ER
h = ts(H, start=s, end = s + n - 1)
d = ts(D, start=s, end = s + n - 1)
pr = ts(PR, start=s, end = s + n - 1)
lines(pr, col = 'blue')
lines(h, col = 'red')
lines(d, col = 'red')
predictLm3
summary(predictLm3 )
plot(data, main = 'Počet porazených ošípaných za obdobie január 1985 - August 1995', ylab = 'Počet porazených ošípaných', type ='o')
#t_predict = length(t):(length(t+3))
#t_predict = 1:(length(t))
n = 3
tx = (length(t)+1):(length(t)+n)
predictLm3 = ts(predict.lm(lmData3, newdata = data.frame(t = tx, t2 = tx*tx, t3 = tx*tx*tx)))
predictMA1 = predict(modelMA1, n.ahead = n)
predictMA1
s = t[length(t)] + 1
PR = predictMA1$pred
ER = predictMA1$se
H = PR + 1.96 * ER
D = PR - 1.96 * ER
h = predictLm3 + ts(H, start=s, end = s + n - 1)
d = predictLm3 + ts(D, start=s, end = s + n - 1)
pr = predictLm3 + ts(PR, start=s, end = s + n - 1)
lines(pr, col = 'blue')
lines(h, col = 'red')
lines(d, col = 'red')
plot(pr)
plot(predictMA1)
plot(tx, predictMA1)
plot(tx, predictLm3)
plot(t, dataOsipane, main = 'Počet porazených ošípaných za obdobie január 1985 - August 1995', ylab = 'Počet porazených ošípaných', type ='o')
#t_predict = length(t):(length(t+3))
#t_predict = 1:(length(t))
n = 3
s = t[length(t)] + 1
tx = s:(length(t)+n)
predictLm3 = ts(predict.lm(lmData3, newdata = data.frame(t = tx, t2 = tx*tx, t3 = tx*tx*tx)))
predictMA1 = predict(modelMA1, n.ahead = n)
predictMA1
PR = predictMA1$pred
ER = predictMA1$se
H = PR + 1.96 * ER
D = PR - 1.96 * ER
h = predictLm3 + ts(H)
d = predictLm3 + ts(D)
pr = predictLm3 + ts(PR)
lines(tx, pr, col = 'blue')
lines(tx, h, col = 'red')
lines(tx, d, col = 'red')
plot(tx, predictLm3)
plot(t, dataOsipane, main = 'Počet porazených ošípaných za obdobie január 1985 - August 1995', ylab = 'Počet porazených ošípaných', type ='o')
#t_predict = length(t):(length(t+3))
#t_predict = 1:(length(t))
n = 3
s = t[length(t)] + 1
tx = s:(length(t)+n)
predictLm3 = ts(predict.lm(lmData3, newdata = data.frame(t = tx, t2 = tx*tx, t3 = tx*tx*tx)))
predictMA1 = predict(modelMA1, n.ahead = n)
predictMA1
PR = predictMA1$pred
ER = predictMA1$se
H = PR + 1.96 * ER
D = PR - 1.96 * ER
h = predictLm3 + ts(H)
d = predictLm3 + ts(D)
pr = predictLm3 + ts(PR)
lines(tx, pr, col = 'blue', type = 'o')
lines(tx, h, col = 'red')
lines(tx, d, col = 'red')
plot(t, dataOsipane, main = 'Počet porazených ošípaných za obdobie január 1985 - August 1995', ylab = 'Počet porazených ošípaných', type ='o')
#t_predict = length(t):(length(t+3))
#t_predict = 1:(length(t))
n = 3
s = t[length(t)] + 1
tx = s:(length(t)+n)
predictLm3 = ts(predict.lm(lmData3, newdata = data.frame(t = tx, t2 = tx*tx, t3 = tx*tx*tx)))
predictMA1 = predict(modelMA1, n.ahead = n)
predictMA1
PR = predictMA1$pred
ER = predictMA1$se
H = PR + 1.96 * ER
D = PR - 1.96 * ER
h = predictLm3 + ts(H)
d = predictLm3 + ts(D)
pr = predictLm3 + ts(PR)
lines(tx, pr, col = 'blue', type = 'o')
lines(tx, h, col = 'red')
lines(tx, d, col = 'red')
Osipane <- read.table("Osipane.txt", quote="\"", comment.char="")
dataOsipane = Osipane$V1
plot(dataOsipane, main = 'Počet porazených ošípaných za obdobie január 1985 - August 1995', ylab = 'Počet porazených ošípaných', type ='o')
t = 1:length(dataOsipane)
t2 = t*t
lmData2 = lm(dataOsipane~t+t2)
plot(dataOsipane, main = 'Počet porazených ošípaných za obdobie január 1985 - August 1995', ylab = 'Počet porazených ošípaných', type ='o')
lines(t, predict(lmData2), col='red')
show(lmData2)
resLm2 = residuals(lmData2)
plot(resLm2, main = 'Reziduá po fite kubickou funkciou',type='o')
t = 1:length(dataOsipane)
t2 = t*t
t3 = t2*t
lmData3 = lm(dataOsipane~t+t2+t3)
plot(dataOsipane, main = 'Počet porazených ošípaných za obdobie január 1985 - August 1995', ylab = 'Počet porazených ošípaných', type ='o')
lines(t, predict(lmData3), col='red')
summary(lmData3)
resLm3 = residuals(lmData3)
plot(resLm3, main = 'Reziduá po fite kubickou funkciou',type='o')
acfLm3 = acf(resLm3,40)
pacfLm3 = pacf(resLm3,40)
Box.test(resLm3)
Box.test(resLm3, type='Ljung')
modelMA1 = arima(resLm3, order=c(0,0,1))
resMA1 = residuals(modelMA1)
plot(resMA1, main='Rezidá MA(1) modelu.', type ='o')
# PACF a ACF
pacfMA1 = pacf(resMA1,40)
acfMA1 = acf(resMA1, 40)
# Box testy
Box.test(resMA1)
Box.test(resMA1, type = 'Ljung')
# Test normality pre reziduá
shapiro.test(resMA1)
coefficients(modelMA1)
pgramData <- spec.pgram(resMA1, log='no')
plot(t, dataOsipane, main = 'Počet porazených ošípaných za obdobie január 1985 - August 1995', ylab = 'Počet porazených ošípaných', type ='o')
#t_predict = length(t):(length(t+3))
#t_predict = 1:(length(t))
n = 3
s = t[length(t)] + 1
tx = s:(length(t)+n)
predictLm3 = ts(predict.lm(lmData3, newdata = data.frame(t = tx, t2 = tx*tx, t3 = tx*tx*tx)))
predictMA1 = predict(modelMA1, n.ahead = n)
predictMA1
PR = predictMA1$pred
ER = predictMA1$se
H = PR + 1.96 * ER
D = PR - 1.96 * ER
h = predictLm3 + ts(H)
d = predictLm3 + ts(D)
pr = predictLm3 + ts(PR)
lines(tx, pr, col = 'blue', type = 'o')
lines(tx, h, col = 'red')
lines(tx, d, col = 'red')
